pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: #283538;","}","","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #283538;","}","","#application-splash {","    position: absolute;","    top: calc(50% - 28px);","    width: 264px;","    left: calc(50% - 132px);","}","","#application-splash img {","    width: 100%;","}","","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","#video{","position:absolute;","top:0%;","left:0%;","z-index:100;","display:block;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";var a=document.createElement("img");a.src="https://media.licdn.com/dms/image/C560BAQEnEFtRaZ6u6w/company-logo_200_200/0/1661764216397?e=2147483647&v=beta&t=Tjqyf3bXe4KcCXIqiJzZ3p3oNN08g0JP1ydvALDkORE",t.appendChild(a),a.onload=function(){t.style.display="block"};var o=document.createElement("div");o.id="progress-bar-container",t.appendChild(o);var n=document.createElement("div");n.id="progress-bar",o.appendChild(n)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("preload:progress",(function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%")})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)}))}));var Video=pc.createScript("video");Video.attributes.add("videoAsset",{title:"Video Asset",description:"MP4 video asset to play back on this video texture.",type:"asset"}),Video.attributes.add("videoUrl",{title:"Video Url",description:"URL to use if there is video asset selected",type:"string"}),Video.attributes.add("playEvent",{title:"Play Event",description:"Event that is fired as soon as the video texture is ready to play.",type:"string",default:""}),Video.prototype.initialize=function(){var e=this.app,t=document.createElement("video");t.id="myVideo",t.loop=!1,t.muted=!0,t.playsInline=!0,t.crossOrigin="anonymous",t.autoplay=!0;var i=t.style;i.minWidth="100vw",i.minHeight="100vh",i.position="absolute",i.opacity="1",i.zIndex="1000",i.pointerEvents="none",document.body.appendChild(t),this.Video=new pc.Texture(e.graphicsDevice,{format:pc.PIXELFORMAT_R8_G8_B8,minFilter:pc.FILTER_LINEAR_MIPMAP_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,mipmaps:!0}),this.Video.setSource(t),t.addEventListener("canplaythrough",function(i){e.fire(this.playEvent,this.Video),t.play()}.bind(this)),t.src=this.videoAsset?this.videoAsset.getFileUrl():this.videoUrl,console.log(this.videoAsset.getFileUrl()),document.body.appendChild(t),t.load(),this.on("destroy",(function(){this.Video.destroy(),t.remove()}),this),document.getElementById("myVideo").onended=function(){document.body.removeChild(t),e.scenes.changeScene("Container_1 2")}};Object.assign(pc,function(){var OutlineEffect=function(e,t){pc.PostEffect.call(this,e),this.shader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+e.precision+" float;","","#define THICKNESS "+t.toFixed(0),"uniform float uWidth;","uniform float uHeight;","uniform vec4 uOutlineCol;","uniform sampler2D uColorBuffer;","uniform sampler2D uOutlineTex;","","varying vec2 vUv0;","","void main(void)","{","    vec4 texel1 = texture2D(uColorBuffer, vUv0);","    float sample0 = texture2D(uOutlineTex, vUv0).a;","    float outline = 0.0;","    if (sample0==0.0)","    {","        for (int x=-THICKNESS;x<=THICKNESS;x++)","        {","            for (int y=-THICKNESS;y<=THICKNESS;y++)","            {    ","                float sample=texture2D(uOutlineTex, vUv0+vec2(float(x)/uWidth, float(y)/uHeight)).a;","                if (sample>0.0)","                {","                    outline=1.0;","                }","            }","        } ","    }","    gl_FragColor = mix(texel1, uOutlineCol, outline * uOutlineCol.a);","}"].join("\n")}),this.color=new pc.Color(1,1,1,1),this.texture=new pc.Texture(e),this.texture.name="pe-outline"};(OutlineEffect.prototype=Object.create(pc.PostEffect.prototype)).constructor=OutlineEffect;var e=[0,0,0,0];return Object.assign(OutlineEffect.prototype,{render:function(t,i,o){var r=this.device,u=r.scope;u.resolve("uWidth").setValue(t.width),u.resolve("uHeight").setValue(t.height),e[0]=this.color.r,e[1]=this.color.g,e[2]=this.color.b,e[3]=this.color.a,u.resolve("uOutlineCol").setValue(e),u.resolve("uColorBuffer").setValue(t.colorBuffer),u.resolve("uOutlineTex").setValue(this.texture),pc.drawFullscreenQuad(r,i,this.vertexBuffer,this.shader,o)}}),{OutlineEffect:OutlineEffect}}());var Outline=pc.createScript("outline");Outline.attributes.add("color",{type:"rgb",default:[.5,.5,.5,1],title:"Color"}),Outline.attributes.add("texture",{type:"asset",assetType:"texture",title:"Texture"}),Outline.prototype.initialize=function(){this.effect=new pc.OutlineEffect(this.app.graphicsDevice),this.effect.color=this.color,this.effect.texture=this.texture.resource;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)})),this.on("attr:color",(function(e){this.effect.color=e}),this),this.on("attr:texture",(function(e){this.effect.texture=e?e.resource:null}),this)};var CharacterController=pc.createScript("characterController");CharacterController.attributes.add("speed",{type:"number",default:5}),CharacterController.attributes.add("jumpImpulse",{type:"number",default:200}),CharacterController.prototype.initialize=function(){this.groundCheckRay=new pc.Vec3(0,-1.2,0),this.rayEnd=new pc.Vec3,this.groundNormal=new pc.Vec3,this.onGround=!0,this.jumping=!1},CharacterController.prototype.move=function(t){if(this.onGround&&!this.jumping){var r=new pc.Vec3,e=t.length();e>0&&(r.cross(this.groundNormal,t).cross(r,this.groundNormal),r.normalize().scale(e*this.speed)),this.entity.rigidbody.linearVelocity=r}},CharacterController.prototype.jump=function(){this.onGround&&!this.jumping&&(this.entity.rigidbody.applyImpulse(0,this.jumpImpulse,0),this.onGround=!1,this.jumping=!0,setTimeout(function(){this.jumping=!1}.bind(this),500))},CharacterController.prototype.update=function(t){var r=this.entity.getPosition();this.rayEnd.add2(r,this.groundCheckRay);var e=this.app.systems.rigidbody.raycastFirst(r,this.rayEnd);this.onGround=!!e,e&&this.groundNormal.copy(e.normal)};var FirstPersonView=pc.createScript("firstPersonView");window.globals=this,window.globals.isPointerLocked=!1,FirstPersonView.attributes.add("camera",{title:"Camera",description:"The camera controlled by this first person view. It should be a child of the entity to which this script is assigned. If no camera is assigned, the script will create one for you.",type:"entity"}),FirstPersonView.prototype.initialize=function(){var e=this.app;this.camera||(this.camera=this.entity.findByName("Camera"),this.camera||(this.camera=new pc.Entity("FPS Camera"),this.camera.addComponent("camera"))),this.x=new pc.Vec3,this.z=new pc.Vec3,this.heading=new pc.Vec3,this.magnitude=new pc.Vec2,this.azimuth=0,this.elevation=0;var t=this.camera.forward.clone();t.y=0,t.normalize(),this.azimuth=Math.atan2(-t.x,-t.z)*(180/Math.PI),(new pc.Mat4).setFromAxisAngle(pc.Vec3.UP,-this.azimuth).transformVector(this.camera.forward,t),this.elevation=Math.atan(t.y,t.z)*(180/Math.PI),this.forward=0,this.strafe=0,this.jump=!1,this.cnt=0,e.on("firstperson:forward",(function(e){this.forward=e}),this),e.on("firstperson:strafe",(function(e){this.strafe=e}),this),e.on("firstperson:look",(function(e,t){this.azimuth+=e,this.elevation+=t,this.elevation=pc.math.clamp(this.elevation,-90,90)}),this),e.on("firstperson:jump",(function(){this.jump=!0}),this)},FirstPersonView.prototype.postUpdate=function(e){this.camera.setEulerAngles(this.elevation,this.azimuth,0),this.z.copy(this.camera.forward),this.z.y=0,this.z.normalize(),this.x.copy(this.camera.right),this.x.y=0,this.x.normalize(),this.heading.set(0,0,0),0!==this.forward&&(this.z.scale(this.forward),this.heading.add(this.z)),0!==this.strafe&&(this.x.scale(this.strafe),this.heading.add(this.x)),this.heading.length()>1e-4&&(this.magnitude.set(this.forward,this.strafe),this.heading.normalize().scale(this.magnitude.length())),this.jump&&(this.entity.script.characterController.jump(),this.jump=!1),this.entity.script.characterController.move(this.heading);var t=this.camera.getPosition();this.app.fire("cameramove",t)};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){var e=this.app,updateMovement=function(t,i){switch(t){case 38:case 87:e.fire("firstperson:forward",i);break;case 40:case 83:e.fire("firstperson:forward",-i);break;case 37:case 65:e.fire("firstperson:strafe",-i);break;case 39:case 68:e.fire("firstperson:strafe",i)}},keyDown=function(t){t.repeat||(updateMovement(t.keyCode,1),32===t.keyCode&&e.fire("firstperson:jump"))},keyUp=function(e){updateMovement(e.keyCode,0)},addEventListeners=function(){window.addEventListener("keydown",keyDown,!0),window.addEventListener("keyup",keyUp,!0)};this.on("enable",addEventListeners),this.on("disable",(function(){window.addEventListener("keydown",keyDown,!0),window.addEventListener("keyup",keyUp,!0)})),addEventListeners()};var MouseInput=pc.createScript("mouseInput");function applyRadialDeadZone(e,t,i,s){var a=e.length();if(a>i){var n=1-s-i,r=Math.min(1,(a-i)/n)/a;t.copy(e).scale(r)}else t.set(0,0)}MouseInput.prototype.initialize=function(){var e=this.app,t=e.graphicsDevice.canvas,mouseDown=function(e){document.pointerLockElement!==t&&t.requestPointerLock},mouseMove=function(t){var i=event.movementX||event.webkitMovementX||event.mozMovementX||0,s=event.movementY||event.webkitMovementY||event.mozMovementY||0;e.fire("firstperson:look",-i/5,-s/5)},addEventListeners=function(){window.addEventListener("mousedown",mouseDown,!1),window.addEventListener("mousemove",mouseMove,!1)};this.on("enable",addEventListeners),this.on("disable",(function(){window.removeEventListener("mousedown",mouseDown,!1),window.removeEventListener("mousemove",mouseMove,!1)})),addEventListeners()};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("deadZone",{title:"Dead Zone",description:"Radial thickness of inner dead zone of the virtual joysticks. This dead zone ensures the virtual joysticks report a value of 0 even if a touch deviates a small amount from the initial touch.",type:"number",min:0,max:.4,default:.3}),TouchInput.attributes.add("turnSpeed",{title:"Turn Speed",description:"Maximum turn speed in degrees per second",type:"number",default:150}),TouchInput.attributes.add("radius",{title:"Radius",description:"The radius of the virtual joystick in CSS pixels.",type:"number",default:50}),TouchInput.attributes.add("doubleTapInterval",{title:"Double Tap Interval",description:"The time in milliseconds between two taps of the right virtual joystick for a double tap to register. A double tap will trigger a jump.",type:"number",default:300}),TouchInput.prototype.initialize=function(){var e=this.app,t=e.graphicsDevice,i=t.canvas;this.remappedPos=new pc.Vec2,this.leftStick={identifier:-1,center:new pc.Vec2,pos:new pc.Vec2},this.rightStick={identifier:-1,center:new pc.Vec2,pos:new pc.Vec2},this.lastRightTap=0;var s=function(s){s.preventDefault();for(var a=t.width/i.clientWidth,n=t.height/i.clientHeight,r=s.changedTouches,o=0;o<r.length;o++){var h=r[o];if(h.pageX<=i.clientWidth/2&&-1===this.leftStick.identifier)this.leftStick.identifier=h.identifier,this.leftStick.center.set(h.pageX,h.pageY),this.leftStick.pos.set(0,0),e.fire("leftjoystick:enable",h.pageX*a,h.pageY*n);else if(h.pageX>i.clientWidth/2&&-1===this.rightStick.identifier){this.rightStick.identifier=h.identifier,this.rightStick.center.set(h.pageX,h.pageY),this.rightStick.pos.set(0,0),e.fire("rightjoystick:enable",h.pageX*a,h.pageY*n);var d=Date.now();this.lastRightTap,this.doubleTapInterval,this.lastRightTap=d}}}.bind(this),a=function(s){s.preventDefault();for(var a=t.width/i.clientWidth,n=t.height/i.clientHeight,r=s.changedTouches,o=0;o<r.length;o++){var h=r[o];h.identifier===this.leftStick.identifier?(this.leftStick.pos.set(h.pageX,h.pageY),this.leftStick.pos.sub(this.leftStick.center),this.leftStick.pos.scale(1/this.radius),e.fire("leftjoystick:move",h.pageX*a,h.pageY*n)):h.identifier===this.rightStick.identifier&&(this.rightStick.pos.set(h.pageX,h.pageY),this.rightStick.pos.sub(this.rightStick.center),this.rightStick.pos.scale(1/this.radius),e.fire("rightjoystick:move",h.pageX*a,h.pageY*n))}}.bind(this),n=function(t){t.preventDefault();for(var i=t.changedTouches,s=0;s<i.length;s++){var a=i[s];a.identifier===this.leftStick.identifier?(this.leftStick.identifier=-1,e.fire("firstperson:forward",0),e.fire("firstperson:strafe",0),e.fire("leftjoystick:disable")):a.identifier===this.rightStick.identifier&&(this.rightStick.identifier=-1,e.fire("rightjoystick:disable"))}}.bind(this),addEventListeners=function(){i.addEventListener("touchstart",s,!1),i.addEventListener("touchmove",a,!1),i.addEventListener("touchend",n,!1)};this.on("enable",addEventListeners),this.on("disable",(function(){i.removeEventListener("touchstart",s,!1),i.removeEventListener("touchmove",a,!1),i.removeEventListener("touchend",n,!1)})),addEventListeners()},TouchInput.prototype.update=function(e){var t=this.app;if(-1!==this.leftStick.identifier){applyRadialDeadZone(this.leftStick.pos,this.remappedPos,this.deadZone,0);var i=this.remappedPos.x;this.lastStrafe!==i&&(t.fire("firstperson:strafe",i),this.lastStrafe=i);var s=-this.remappedPos.y;this.lastForward!==s&&(t.fire("firstperson:forward",s),this.lastForward=s)}if(-1!==this.rightStick.identifier){applyRadialDeadZone(this.rightStick.pos,this.remappedPos,this.deadZone,0);var a=-this.remappedPos.x*this.turnSpeed*e,n=-this.remappedPos.y*this.turnSpeed*e;t.fire("firstperson:look",a,n)}};var GamePadInput=pc.createScript("gamePadInput");GamePadInput.attributes.add("deadZoneLow",{title:"Low Dead Zone",description:"Radial thickness of inner dead zone of pad's joysticks. This dead zone ensures that all pads report a value of 0 for each joystick axis when untouched.",type:"number",min:0,max:.4,default:.1}),GamePadInput.attributes.add("deadZoneHigh",{title:"High Dead Zone",description:"Radial thickness of outer dead zone of pad's joysticks. This dead zone ensures that all pads can reach the -1 and 1 limits of each joystick axis.",type:"number",min:0,max:.4,default:.1}),GamePadInput.attributes.add("turnSpeed",{title:"Turn Speed",description:"Maximum turn speed in degrees per second",type:"number",default:90}),GamePadInput.prototype.initialize=function(){this.app;this.lastStrafe=0,this.lastForward=0,this.lastJump=!1,this.remappedPos=new pc.Vec2,this.leftStick={center:new pc.Vec2,pos:new pc.Vec2},this.rightStick={center:new pc.Vec2,pos:new pc.Vec2};var addEventListeners=function(){window.addEventListener("gamepadconnected",(function(e){})),window.addEventListener("gamepaddisconnected",(function(e){}))};this.on("enable",addEventListeners),this.on("disable",(function(){window.removeEventListener("gamepadconnected",(function(e){})),window.removeEventListener("gamepaddisconnected",(function(e){}))})),addEventListeners()},GamePadInput.prototype.update=function(e){for(var t=this.app,i=navigator.getGamepads?navigator.getGamepads():[],s=0;s<i.length;s++){var a=i[s];if(a&&"standard"===a.mapping&&a.axes.length>=4){this.leftStick.pos.set(a.axes[0],a.axes[1]),applyRadialDeadZone(this.leftStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh);var n=this.remappedPos.x;this.lastStrafe!==n&&(t.fire("firstperson:strafe",n),this.lastStrafe=n);var r=-this.remappedPos.y;this.lastForward!==r&&(t.fire("firstperson:forward",r),this.lastForward=r),this.rightStick.pos.set(a.axes[2],a.axes[3]),applyRadialDeadZone(this.rightStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh);var o=-this.remappedPos.x*this.turnSpeed*e,h=-this.remappedPos.y*this.turnSpeed*e;t.fire("firstperson:look",o,h),a.buttons[0].pressed&&this.lastJump,this.lastJump=a.buttons[0].pressed}}};var AddSingleCollisionMesh=pc.createScript("addSingleCollisionMesh");AddSingleCollisionMesh.attributes.add("modelContainerAsset",{type:"asset",assetType:"container"}),AddSingleCollisionMesh.prototype.initialize=function(){this.modelContainerAsset&&this.entity.collision&&"mesh"===this.entity.collision.type&&(this.entity.collision.asset=this.modelContainerAsset.resource.model)};var Main=pc.createScript("main");Main.prototype.initialize=function(){this.entity.camera?(this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.mouseDown,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.touchStart,this)):console.error("This script must be applied to an entity with a camera component.")};var script=document.createElement("script");script.src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/4.3.7/mqtt.min.js",document.head.appendChild(script),Main.prototype.mouseDown=function(t){this.doRaycast(t.x,t.y)},Main.prototype.touchStart=function(t){1===t.touches.length&&this.doRaycast(t.touches[0].x,t.touches[0].y),t.event.preventDefault()},Main.prototype.doRaycast=function(t,i){var e=this.entity.getPosition(),o=this.app.root.findByName("selected box");if(o)for(var a=o.children,n=0;n<a.length;n++)a[n].addComponent("collision",{type:"box"});var s=this.entity.camera.screenToWorld(t,i,this.entity.camera.farClip),c=this.app.systems.rigidbody.raycastFirst(e,s);if(c)c.entity};var Ui=pc.createScript("ui");Ui.attributes.add("html",{type:"asset",assetType:"html"}),Ui.attributes.add("css",{type:"asset",assetType:"css"}),Ui.attributes.add("allData",{type:"asset",assetType:"json"}),Ui.prototype.initialize=function(){Ui.boxData=this.allData,this.div=document.createElement("div"),this.div.id="trainDetails",this.div.innerHTML=this.html.resource||"",document.body.appendChild(this.div);var t=document.createElement("style");t.innerHTML=this.css.resource||"",document.head.appendChild(t),t=pc.createStyle(this.css.resource),document.head.appendChild(t);var e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/4.3.7/mqtt.min.js",document.head.appendChild(e)};var ApplyOutline=pc.createScript("applyOutline");ApplyOutline.attributes.add("color",{type:"rgba"}),ApplyOutline.attributes.add("thickness",{type:"number",default:1,min:1,max:10,precision:0,title:"Thickness"}),ApplyOutline.prototype.initialize=function(){this.vec=new pc.Vec3,this.prepare(),window.addEventListener("resize",this.onResize.bind(this)),this.app.on("Ermis:objectOutline:add",(function(e){if(e&&e.render&&-1===e.render.layers.indexOf(this.outlineLayer.id)){var t=e.render.layers.slice();t.push(this.outlineLayer.id),e.render.layers=t}}),this),this.app.on("Ermis:objectOutline:remove",(function(e){if(e.render)var t=e.render.layers.indexOf(this.outlineLayer.id);if(e&&e.render&&t>-1){var i=e.render.layers.slice();i.splice(t,1),e.render.layers=i}}),this)},ApplyOutline.prototype.prepare=function(){this.texture=new pc.Texture(this.app.graphicsDevice,{width:this.app.graphicsDevice.width,height:this.app.graphicsDevice.height,format:pc.PIXELFORMAT_R8_G8_B8_A8,autoMipmap:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR}),this.renderTarget=new pc.RenderTarget({colorBuffer:this.texture,depth:!0,samples:8}),this.worldLayer=this.app.scene.layers.getLayerByName("World"),this.outlineLayer=this.app.scene.layers.getLayerByName("OutlineLayer"),this.outlineLayer&&(this.outlineLayer.renderTarget=this.renderTarget),this.outlineCamera=new pc.Entity,this.outlineCamera.addComponent("camera",{clearColor:new pc.Color(0,0,0,0),layers:[this.outlineLayer.id],fov:this.app.root.findByName("Camera").camera.fov}),this.app.root.addChild(this.outlineCamera),this.outlineCamera.camera.priority=0,this.outline=new pc.OutlineEffect(this.app.graphicsDevice,this.thickness),this.outline.color=new pc.Color(0,0,1,1),this.outline.texture=this.texture,this.entity.camera.postEffects.addEffect(this.outline)},ApplyOutline.prototype.onResize=function(){this.entity.camera.postEffects.removeEffect(this.outline),this.app.scene.layers.remove(this.outlineLayer),this.texture.destroy(),this.texture=new pc.Texture(this.app.graphicsDevice,{width:this.app.graphicsDevice.width,height:this.app.graphicsDevice.height,format:pc.PIXELFORMAT_R8_G8_B8_A8,autoMipmap:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR}),this.renderTarget.destroy(),this.renderTarget=new pc.RenderTarget(this.app.graphicsDevice,this.texture,{depth:!0}),this.outlineLayer.renderTarget=this.renderTarget,this.app.scene.layers.insert(this.outlineLayer,0),this.outline.texture=this.texture,this.entity.camera.postEffects.addEffect(this.outline)},ApplyOutline.prototype.update=function(e){var t=this.entity.getWorldTransform();this.outlineCamera.setPosition(t.getTranslation()),this.outlineCamera.setEulerAngles(t.getEulerAngles()),this.outlineCamera.setLocalScale(t.getScale()),this.outlineCamera.camera.horizontalFov=!(this.app.graphicsDevice.width>this.app.graphicsDevice.height),this.outline.color.copy(this.color)};var ClickToHighlight=pc.createScript("clickToHighlight");ClickToHighlight.attributes.add("boxDetailHtml",{type:"asset",assetType:"html"}),ClickToHighlight.attributes.add("unsafeBoxDetailHtml",{type:"asset",assetType:"html"}),ClickToHighlight.attributes.add("criticalBoxHtml",{type:"asset",assetType:"html"}),ClickToHighlight.attributes.add("boxDetailCss",{type:"asset",assetType:"css"}),ClickToHighlight.attributes.add("allData",{type:"asset",assetType:"json"}),ClickToHighlight.prototype.initialize=function(){this.cameraEntity=this.entity,this.previous=void 0,this.app.touch?this.app.touch.on(pc.EVENT_TOUCHSTART,this.touchStart,this):this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.mouseDown,this)},ClickToHighlight.prototype.mouseDown=function(e){this.doRaycast(e)},ClickToHighlight.prototype.touchStart=function(e){1==e.touches.length&&this.doRaycast(e.touches[0]),e.event.preventDefault()},ClickToHighlight.prototype.doRaycast=function(e){var t=this.cameraEntity.getPosition(),i=this.cameraEntity.camera.screenToWorld(e.x,e.y,this.cameraEntity.camera.farClip),a=this.app.systems.rigidbody.raycastFirst(t,i);if(a){if(this.allData.resource[a.entity.name]?.temperature>="0 °C"&&this.allData.resource[a.entity.name]?.temperature<="50 °C"){this.app.fire("Ermis:objectOutline:add",a.entity),(l=document.getElementById("boxDetails"))?.remove(),(c=document.getElementById("unsafeBoxDetails"))?.remove(),(u=document.getElementById("orangeBoxDetails"))?.remove(),this.div=document.createElement("div"),this.div.id="boxDetails",this.div.innerHTML=this.boxDetailHtml.resource||"",document.body.appendChild(this.div),(o=document.createElement("style")).innerHTML=this.boxDetailCss.resource||"",document.head.appendChild(o),o=pc.createStyle(this.boxDetailCss.resource),document.head.appendChild(o),document.querySelector("#safe").innerText=this.allData.resource[a.entity.name]?.status,document.querySelector("#sealDateAndTimeDetails").innerText=this.allData.resource[a.entity.name]?.sealDateAndTime,document.querySelector("#itemCodeDetails").innerText=this.allData.resource[a.entity.name]?.itemCode,document.querySelector("#weightDetails").innerText=this.allData.resource[a.entity.name]?.weight,document.querySelector("#sizeDetails").innerText=this.allData.resource[a.entity.name]?.size,document.querySelector("#noteDetails").innerText=this.allData.resource[a.entity.name]?.note,document.querySelector("#locationDetails").innerText=this.allData.resource[a.entity.name]?.location,document.querySelector("#temperatureDetails").innerText=this.allData.resource[a.entity.name]?.temperature,document.querySelector("#toleranceDetails").innerText=this.allData.resource[a.entity.name]?.tolerance,document.querySelector("#lockDetails").innerText=this.allData.resource[a.entity.name]?.lock;var n=this.app.assets.find("tick.png","texture").getFileUrl();document.querySelector("#img").src=n}else if(this.allData.resource[a.entity.name]?.temperature>="60 °C"){(c=document.getElementById("unsafeBoxDetails"))?.remove(),(l=document.getElementById("boxDetails"))?.remove(),(u=document.getElementById("orangeBoxDetails"))?.remove(),this.div=document.createElement("div"),this.div.id="unsafeBoxDetails",this.div.innerHTML=this.unsafeBoxDetailHtml.resource||"",document.body.appendChild(this.div),(o=document.createElement("style")).innerHTML=this.boxDetailCss.resource||"",document.head.appendChild(o),o=pc.createStyle(this.boxDetailCss.resource),document.head.appendChild(o),document.querySelector("#unsafe").innerText=this.allData.resource[a.entity.name]?.status,document.querySelector("#unsafeSealDateAndTimeDetails").innerText=this.allData.resource[a.entity.name]?.sealDateAndTime,document.querySelector("#unsafeItemCodeDetails").innerText=this.allData.resource[a.entity.name]?.itemCode,document.querySelector("#unsafeWeightDetails").innerText=this.allData.resource[a.entity.name]?.weight,document.querySelector("#unsafeSizeDetails").innerText=this.allData.resource[a.entity.name]?.size,document.querySelector("#unsafeNoteDetails").innerText=this.allData.resource[a.entity.name]?.note,document.querySelector("#unsafeLocationDetails").innerText=this.allData.resource[a.entity.name]?.location,document.querySelector("#unSafeTemperatureDetails").innerText=this.allData.resource[a.entity.name]?.temperature,document.querySelector("#unsafeToleranceDetails").innerText=this.allData.resource[a.entity.name]?.tolerance,document.querySelector("#unsafeLockDetails").innerText=this.allData.resource[a.entity.name]?.lock;var r=this.app.assets.find("caution.png","texture").getFileUrl();document.querySelector("#unsafeImg").src=r}else if(this.allData.resource[a.entity.name]?.temperature>="51 °C"&&this.allData.resource[a.entity.name]?.temperature<="60 °C"){var o;(c=document.getElementById("unsafeBoxDetails"))?.remove(),(l=document.getElementById("boxDetails"))?.remove(),(u=document.getElementById("orangeBoxDetails"))?.remove(),this.div=document.createElement("div"),this.div.id="orangeBoxDetails",this.div.innerHTML=this.criticalBoxHtml.resource||"",document.body.appendChild(this.div),(o=document.createElement("style")).innerHTML=this.boxDetailCss.resource||"",document.head.appendChild(o),o=pc.createStyle(this.boxDetailCss.resource),document.head.appendChild(o),document.querySelector("#critical").innerText=this.allData.resource[a.entity.name]?.status,document.querySelector("#orangeSealDateAndTimeDetails").innerText=this.allData.resource[a.entity.name]?.sealDateAndTime,document.querySelector("#orangeItemCodeDetails").innerText=this.allData.resource[a.entity.name]?.itemCode,document.querySelector("#orangeWeightDetails").innerText=this.allData.resource[a.entity.name]?.weight,document.querySelector("#orangeSizeDetails").innerText=this.allData.resource[a.entity.name]?.size,document.querySelector("#orangeNoteDetails").innerText=this.allData.resource[a.entity.name]?.note,document.querySelector("#orangeLocationDetails").innerText=this.allData.resource[a.entity.name]?.location,document.querySelector("#orangeTemperatureDetails").innerText=this.allData.resource[a.entity.name]?.temperature,document.querySelector("#orangeToleranceDetails").innerText=this.allData.resource[a.entity.name]?.tolerance,document.querySelector("#orangeLockDetails").innerText=this.allData.resource[a.entity.name]?.lock;var s=this.app.assets.find("Icon.png","texture").getFileUrl();document.querySelector("#orangeImg").src=s}else if("phy wall shipping container v2"===a.entity.name){var l,c,u;(l=document.getElementById("mainContainer"))&&(l.style.display="none"),(c=document.getElementById("mainUnSafeContainer"))&&(c.style.display="none"),(u=document.getElementById("orangeBoxDetails"))&&(u.style.display="none")}this.previous&&this.previous._guid!==a.entity._guid&&this.app.fire("Ermis:objectOutline:remove",this.previous),this.previous=a.entity}else this.previous&&(this.app.fire("Ermis:objectOutline:remove",this.previous),this.previous=void 0)};var Highlight=pc.createScript("highlight");Highlight.prototype.initialize=function(){this.cameraEntity=this.entity,this.displayRedOutline()},Highlight.prototype.displayRedOutline=function(){for(var i=this.app.root.findByName("selected box").children,t=0;t<=i.length;t++)this.app.fire("Ermis:objectRedOutline:add",i[t])};var ApplyRedOutline=pc.createScript("applyRedOutline");ApplyRedOutline.attributes.add("color",{type:"rgba"}),ApplyRedOutline.attributes.add("thickness",{type:"number",default:1,min:1,max:10,precision:0,title:"Thickness"}),ApplyRedOutline.attributes.add("allData",{type:"asset",assetType:"json"}),ApplyRedOutline.prototype.initialize=function(){this.vec=new pc.Vec3,this.prepare(),this.app.on("Ermis:objectRedOutline:add",(function(e){if(e&&this.allData.resource[e.name]?.temperature>="60 °C"){var t=e.render.layers.slice();t.push(this.redOutlineLayer.id),e.render.layers=t}}),this),this.app.on("Ermis:objectRedOutline:remove",(function(e){if(e.render)var t=e.render.layers.indexOf(this.redOutlineLayer.id);if(e&&e.render&&t>-1){var i=e.render.layers.slice();i.splice(t,1),e.render.layers=i}}),this)},ApplyRedOutline.prototype.prepare=function(){this.texture=new pc.Texture(this.app.graphicsDevice,{width:this.app.graphicsDevice.width,height:this.app.graphicsDevice.height,format:pc.PIXELFORMAT_R8_G8_B8_A8,autoMipmap:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR}),this.renderTarget=new pc.RenderTarget({colorBuffer:this.texture,depth:!0,samples:8}),this.worldLayer=this.app.scene.layers.getLayerByName("World"),this.redOutlineLayer=this.app.scene.layers.getLayerByName("RedOutline"),this.redOutlineLayer&&(this.redOutlineLayer.renderTarget=this.renderTarget),this.outlineCamera=new pc.Entity,this.outlineCamera.addComponent("camera",{clearColor:new pc.Color(0,0,0,0),layers:[this.redOutlineLayer.id],fov:this.app.root.findByName("Camera").camera.fov}),this.app.root.addChild(this.outlineCamera),this.outlineCamera.camera.priority=0,this.outline=new pc.OutlineEffect(this.app.graphicsDevice,this.thickness),this.outline.color=new pc.Color(0,0,1,1),this.outline.texture=this.texture,this.entity.camera.postEffects.addEffect(this.outline)},ApplyRedOutline.prototype.onResize=function(){this.entity.camera.postEffects.removeEffect(this.outline),this.app.scene.layers.remove(this.redOutlineLayer),this.texture.destroy(),this.texture=new pc.Texture(this.app.graphicsDevice,{width:this.app.graphicsDevice.width,height:this.app.graphicsDevice.height,format:pc.PIXELFORMAT_R8_G8_B8_A8,autoMipmap:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR}),this.renderTarget.destroy(),this.renderTarget=new pc.RenderTarget(this.app.graphicsDevice,this.texture,{depth:!0}),this.redOutlineLayer.renderTarget=this.renderTarget,this.app.scene.layers.insert(this.redOutlineLayer,0),this.outline.texture=this.texture,this.entity.camera.postEffects.addEffect(this.outline)},ApplyRedOutline.prototype.update=function(e){var t=this.entity.getWorldTransform();this.outlineCamera.setPosition(t.getTranslation()),this.outlineCamera.setEulerAngles(t.getEulerAngles()),this.outlineCamera.setLocalScale(t.getScale()),this.outlineCamera.camera.horizontalFov=!(this.app.graphicsDevice.width>this.app.graphicsDevice.height),this.outline.color.copy(this.color),this.app.on("Ermis:objectRedOutline:add",(function(e){if(e&&this.allData.resource[e.name]?.temperature>="60 °C"){var t=e.render.layers.slice();t.push(this.redOutlineLayer.id),e.render.layers=t}}),this)};var OrangeHighlight=pc.createScript("orangeHighlight");OrangeHighlight.prototype.initialize=function(){this.cameraEntity=this.entity,this.displayOrangeOutline()},OrangeHighlight.prototype.displayOrangeOutline=function(){for(var i=this.app.root.findByName("selected box").children,t=0;t<=i.length;t++)this.app.fire("Ermis:objectOrangeOutline:add",i[t])};var ApplyOrangeOutline=pc.createScript("applyOrangeOutline");ApplyOrangeOutline.attributes.add("color",{type:"rgba"}),ApplyOrangeOutline.attributes.add("thickness",{type:"number",default:1,min:1,max:10,precision:0,title:"Thickness"}),ApplyOrangeOutline.attributes.add("allData",{type:"asset",assetType:"json"}),ApplyOrangeOutline.prototype.initialize=function(){this.vec=new pc.Vec3,this.prepare(),this.app.on("Ermis:objectOrangeOutline:add",(function(e){if(e&&this.allData.resource[e.name]?.temperature>"50 °C"&&this.allData.resource[e.name]?.temperature<"60 °C"){var t=e.render.layers.slice();t.push(this.orangeOutlineLayer.id),e.render.layers=t}}),this),this.app.on("Ermis:objectOrangeOutline:remove",(function(e){if(e.render)var t=e.render.layers.indexOf(this.orangeOutlineLayer.id);if(e&&e.render&&t>-1){var i=e.render.layers.slice();i.splice(t,1),e.render.layers=i}}),this)},ApplyOrangeOutline.prototype.prepare=function(){this.texture=new pc.Texture(this.app.graphicsDevice,{width:this.app.graphicsDevice.width,height:this.app.graphicsDevice.height,format:pc.PIXELFORMAT_R8_G8_B8_A8,autoMipmap:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR}),this.renderTarget=new pc.RenderTarget({colorBuffer:this.texture,depth:!0,samples:8}),this.worldLayer=this.app.scene.layers.getLayerByName("World"),this.orangeOutlineLayer=this.app.scene.layers.getLayerByName("OrangeOutline"),this.orangeOutlineLayer&&(this.orangeOutlineLayer.renderTarget=this.renderTarget),this.outlineCamera=new pc.Entity,this.outlineCamera.addComponent("camera",{clearColor:new pc.Color(0,0,0,0),layers:[this.orangeOutlineLayer.id],fov:this.app.root.findByName("Camera").camera.fov}),this.app.root.addChild(this.outlineCamera),this.outlineCamera.camera.priority=0,this.outline=new pc.OutlineEffect(this.app.graphicsDevice,this.thickness),this.outline.color=new pc.Color(0,0,1,1),this.outline.texture=this.texture,this.entity.camera.postEffects.addEffect(this.outline)},ApplyOrangeOutline.prototype.onResize=function(){this.entity.camera.postEffects.removeEffect(this.outline),this.app.scene.layers.remove(this.orangeOutlineLayer),this.texture.destroy(),this.texture=new pc.Texture(this.app.graphicsDevice,{width:this.app.graphicsDevice.width,height:this.app.graphicsDevice.height,format:pc.PIXELFORMAT_R8_G8_B8_A8,autoMipmap:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR}),this.renderTarget.destroy(),this.renderTarget=new pc.RenderTarget(this.app.graphicsDevice,this.texture,{depth:!0}),this.orangeOutlineLayer.renderTarget=this.renderTarget,this.app.scene.layers.insert(this.orangeOutlineLayer,0),this.outline.texture=this.texture,this.entity.camera.postEffects.addEffect(this.outline)},ApplyOrangeOutline.prototype.update=function(e){var t=this.entity.getWorldTransform();this.outlineCamera.setPosition(t.getTranslation()),this.outlineCamera.setEulerAngles(t.getEulerAngles()),this.outlineCamera.setLocalScale(t.getScale()),this.outlineCamera.camera.horizontalFov=!(this.app.graphicsDevice.width>this.app.graphicsDevice.height),this.outline.color.copy(this.color),this.app.on("Ermis:objectOrangeOutline:add",(function(e){if(e&&this.allData.resource[e.name]?.temperature>"27 °C"&&this.allData.resource[e.name]?.temperature<"36 °C"){var t=e.render.layers.slice();t.push(this.orangeOutlineLayer.id),e.render.layers=t}}),this)};